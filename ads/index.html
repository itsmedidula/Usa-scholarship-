<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Didula Ads</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }
        
        header {
            background-color: #2c3e50;
            color: white;
            padding: 1rem 0;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .ads-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .ad-card {
            background-color: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .ad-card:hover {
            transform: translateY(-5px);
        }
        
        .ad-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }
        
        .ad-content {
            padding: 15px;
        }
        
        .ad-title {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: #2c3e50;
        }
        
        .ad-description {
            color: #555;
            margin-bottom: 15px;
            font-size: 0.95rem;
        }
        
        .ad-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            font-size: 0.9rem;
            color: #777;
        }
        
        .ad-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 10px;
            border-top: 1px solid #eee;
        }
        
        .contact-info {
            display: flex;
            gap: 10px;
        }
        
        .contact-btn {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background-color 0.3s;
        }
        
        .contact-btn:hover {
            background-color: #2980b9;
        }
        
        .phone-icon, .whatsapp-icon {
            font-size: 1.2rem;
            margin-right: 5px;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            font-size: 1.2rem;
            color: #777;
        }
        
        footer {
            background-color: #2c3e50;
            color: white;
            text-align: center;
            padding: 20px 0;
            margin-top: 40px;
        }
        
        @media (max-width: 768px) {
            .ads-grid {
                grid-template-columns: 1fr;
            }
            
            .ad-footer {
                flex-direction: column;
                gap: 10px;
            }
            
            .contact-info {
                flex-direction: column;
                gap: 5px;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>Didula Ads</h1>
        <p>Find what you're looking for</p>
    </header>

    <div class="container">
        <div id="ads-container">
            <div class="loading">Loading ads...</div>
        </div>
    </div>

    <footer>
        <p>&copy; 2023 Didula Ads. All rights reserved.</p>
    </footer>

    <script>
        // Function to format time ago
        function formatTimeAgo(timeString) {
            const now = new Date();
            const postedTime = new Date(now.getTime() - 8 * 60 * 60 * 1000); // Assuming "8h ago"
            return `${timeString}`;
        }

        // Function to format number with comma separator
        function formatNumber(num) {
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }

        // Fetch ads from API
        async function fetchAds() {
            try {
                const response = await fetch('https://didula-api-web-admin-73ddeae39cc0.herokuapp.com/api/ads?api_key=Didula');
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                const adsContainer = document.getElementById('ads-container');
                
                if (data && data.length > 0) {
                    adsContainer.innerHTML = '';
                    
                    data.forEach(ad => {
                        const adCard = document.createElement('div');
                        adCard.className = 'ad-card';
                        
                        const adHtml = `
                            <img src="${ad.image_url}" alt="${ad.title}" class="ad-image">
                            <div class="ad-content">
                                <h3 class="ad-title">${ad.title}</h3>
                                <p class="ad-description">${ad.short_description}</p>
                                <div class="ad-stats">
                                    <span>${formatNumber(ad.stats.views)} views</span>
                                    <span>${ad.stats.likes} likes</span>
                                    <span>${ad.stats.time_posted}</span>
                                </div>
                                <div class="ad-footer">
                                    <div class="contact-info">
                                        <button class="contact-btn" onclick="window.open('tel:${ad.details.phone_number}', '_blank')">
                                            <span class="phone-icon">ðŸ“ž</span> Call
                                        </button>
                                        <button class="contact-btn" onclick="window.open('https://wa.me/${ad.details.whatsapp_number.replace('+', '')}', '_blank')">
                                            <span class="whatsapp-icon">ðŸ’¬</span> WhatsApp
                                        </button>
                                    </div>
                                    <a href="${ad.ad_link}" target="_blank" class="contact-btn">View Ad</a>
                                </div>
                            </div>
                        `;
                        
                        adCard.innerHTML = adHtml;
                        adsContainer.appendChild(adCard);
                    });
                } else {
                    adsContainer.innerHTML = '<div class="loading">No ads found</div>';
                }
            } catch (error) {
                console.error('Error fetching ads:', error);
                const adsContainer = document.getElementById('ads-container');
                adsContainer.innerHTML = `<div class="loading">Error loading ads: ${error.message}</div>`;
            }
        }

        // Load ads when page loads
        document.addEventListener('DOMContentLoaded', fetchAds);
    </script>
</body>
</html>